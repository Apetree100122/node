# This code is licensed from CircleCI to the user under the MIT license. See
# https://circleci.com/orbs/registry/licensing for details.
version: 2.1
description: Common CI tasks for building and testing Rust crates.

executors:
  default:
    description: Executor environment for building Rust crates.
    docker:
      - image: rust:1

description: Run compiler checks on a Rust crate.
parameters:
  toolchain:
    description: >-
      Rust toolchain to use. Overrides the default toolchain (stable) or any
      toolchain specified in the project via `rust-toolchain`.
    type: string
    default: ''
executor: default
steps:
  - checkout_with_submodules
  - update_toolchain:
      toolchain: <<parameters.toolchain>>
  - check